# SEO HTML Generator Configuration
# 使用 Dynaconf 管理配置
#
# 环境变量覆盖示例:
#   SEO_SERVER__PORT=9000
#   SEO_DATABASE__PASSWORD=secret
#
# 多环境切换:
#   export ENV_FOR_DYNACONF=production

# ============================================
# 默认配置 (所有环境共享)
# ============================================
default:
  # 服务器配置
  server:
    host: "0.0.0.0"
    port: 8010
    workers: 1
    debug: false

  # 缓存配置
  cache:
    enabled: true
    dir: "/data/cache"       # 统一的缓存目录（容器内外路径一致）
    ttl_hours: 24
    max_size_gb: 10.0
    gzip_enabled: true

  # SEO生成配置
  seo:
    internal_links_count: 3856
    encoding_mix_ratio: 0.5
    emoji_count_min: 10
    emoji_count_max: 20

  # 蜘蛛检测配置
  spider_detector:
    enabled: true
    return_404_for_non_spider: true
    dns_verify_enabled: false
    dns_verify_types: ["baidu", "google", "bing"]
    dns_timeout: 2.0
    spiders:
      baidu:
        name: "百度"
        enabled: true
        keywords: ["baiduspider", "baiduspider-render", "baiduspider-image"]
        dns_domains: [".baidu.com", ".baidu.jp"]
      google:
        name: "Google"
        enabled: true
        keywords: ["googlebot", "google-inspectiontool", "googlebot-image"]
        dns_domains: [".googlebot.com", ".google.com"]
      bing:
        name: "Bing"
        enabled: true
        keywords: ["bingbot", "msnbot", "bingpreview"]
        dns_domains: [".search.msn.com"]
      sogou:
        name: "搜狗"
        enabled: true
        keywords: ["sogou spider", "sogou web spider"]
        dns_domains: [".sogou.com"]
      360:
        name: "360搜索"
        enabled: true
        keywords: ["360spider", "haosouspider"]
        dns_domains: [".so.com", ".360.cn"]
      toutiao:
        name: "头条搜索"
        enabled: true
        keywords: ["bytespider", "toutiaospider"]
        dns_domains: [".bytedance.com"]

  # 认证配置
  auth:
    secret_key: "seo-generator-jwt-secret-key-2024"  # 独立的JWT密钥，不依赖数据库密码
    algorithm: "HS256"
    access_token_expire_minutes: 1440
    # 默认管理员账号（首次启动时自动创建）
    default_admin:
      username: "admin"
      password: "admin_6yh7uJ"

  # Redis配置
  redis:
    enabled: true  # 默认关闭，需要时启用
    host: "localhost"
    port: 6379
    db: 0
    password: "redis_6yh7uJ"
    article_cache_ttl: 86400  # 文章缓存24小时
    compress: true
    compress_level: 6

  # Redis 队列配置（Worker 使用）
  queues:
    pending: "pending:articles"
    retry: "pending:articles:retry"
    dead: "pending:articles:dead"

  # Redis 频道配置（Worker 使用）
  channels:
    pool_reload: "pool:reload"
    spider_commands: "spider:commands"
    worker_command: "worker:command"
    processor_commands: "processor:commands"

  # 时间间隔配置（秒）
  intervals:
    stats_update: 5
    bloom_save: 300

  # 数据库配置（默认值，可被环境特定配置覆盖）
  database:
    host: "localhost"
    port: 3306
    user: "root"
    password: ""
    database: "seo_generator"
    charset: "utf8mb4"
    pool_size: 10
    pool_recycle: 3600

  # 数据文件路径（关键词和图片URL现在存储在MySQL中）
  data:
    emojis: "./data/emojis.json"

# ============================================
# 开发环境
# ============================================
development:
  server:
    host: "127.0.0.1"
    debug: true

  database:
    host: "localhost"
    port: 3306
    user: "root"
    password: "mysql_6yh7uJ"
    database: "seo_generator"
    charset: "utf8mb4"
    pool_size: 5
    pool_recycle: 3600

  redis:
    enabled: true  # 开发环境启用Redis
    host: "localhost"
    port: 6379
    password: "redis_6yh7uJ"

# ============================================
# 生产环境
# ============================================
production:
  server:
    host: "0.0.0.0"
    workers: 4
    debug: false

  database:
    host: "@format {env[DB_HOST]}"
    port: "@int @format {env[DB_PORT]}"
    user: "@format {env[DB_USER]}"
    password: "@format {env[DB_PASSWORD]}"
    database: "@format {env[DB_NAME]}"
    charset: "utf8mb4"
    pool_size: 50
    pool_recycle: 1800

  redis:
    enabled: "@bool @format {env[REDIS_ENABLED]}"
    host: "@format {env[REDIS_HOST]}"
    port: "@int @format {env[REDIS_PORT]}"
    db: "@int @format {env[REDIS_DB]}"
    password: "@format {env[REDIS_PASSWORD]}"

  cache:
    max_size_gb: 50.0
