# 数据处理页面合并设计

## 背景

当前后台管理中"数据加工"和"数据加工代码"是两个独立的菜单和页面，用户在使用时需要频繁切换：
- 发现处理出错 → 查看日志 → 修改代码 → 返回监控

这种分离的设计增加了操作步骤，影响工作效率。

## 设计目标

将两个页面合并为一个"数据处理"页面，使用 Tab 切换，让用户在一个页面内完成监控和代码编辑。

## 菜单变化

```
变更前                    变更后
├─ 数据抓取              ├─ 数据抓取
├─ 抓取统计              ├─ 抓取统计
├─ 数据加工         →    ├─ 数据处理（合并后）
├─ 数据加工代码          │
├─ 生成器管理            ├─ 生成器管理
```

## 页面结构

### 整体布局

```
┌─────────────────────────────────────────────┐
│  [监控面板]  [代码编辑]                      │  ← Tab 直接在顶部
├─────────────────────────────────────────────┤
│                                             │
│         （Tab 对应的内容区域）                │
│                                             │
└─────────────────────────────────────────────┘
```

### 监控面板 Tab

```
┌─────────────────────────────────────────────┐
│ 状态卡片区                         [刷新]   │
│ ┌─────┬─────┬─────┬─────┬─────┬─────┐      │
│ │待处理│重试 │死信 │今日 │速度 │状态 │      │
│ └─────┴─────┴─────┴─────┴─────┴─────┘      │
├──────────────────────┬──────────────────────┤
│ 操作 + 配置          │ 统计信息 + 最近错误   │
└──────────────────────┴──────────────────────┘
```

- 去掉原有的页面标题区域
- 刷新按钮移到状态卡片区右侧
- 其余内容保持不变

### 代码编辑 Tab

```
┌─────────────────────────────────────────────┐
│  [监控面板]  [代码编辑]                      │
├─────────────────────────────────────────────┤
│ 文件树    │  代码编辑器                      │
│           │  ┌─────────────────────────────┐│
│ ▼ core/   │  │                             ││
│   spider  │  │      Monaco Editor          ││
│   worker  │  │                             ││
│ ▼ ...     │  └─────────────────────────────┘│
│           ├─────────────────────────────────┤
│  [重启]   │  日志输出                        │
│  [重建]   │  > 运行结果...                   │
└───────────┴─────────────────────────────────┘
```

- 左侧：文件树 + 重启/重建按钮
- 右上：Monaco 代码编辑器
- 右下：日志输出面板（可折叠或拖拽调整高度）
- 布局与现有代码编辑页面一致

## 路由变化

| 变更前 | 变更后 |
|--------|--------|
| `/processor` | `/processor`（保留，作为合并后页面） |
| `/worker` | 删除，重定向到 `/processor` |

## 实现方案

1. 创建新的容器组件 `ProcessorPage.vue`，包含 Tab 切换逻辑
2. 将 `ProcessorManage.vue` 改造为监控面板子组件
   - 去掉页面标题
   - 刷新按钮移到状态卡片区
3. 复用 `WorkerCodeEditor.vue` 作为代码编辑子组件
4. 更新路由配置
   - 修改 `/processor` 指向新容器组件
   - 删除 `/worker` 路由
5. 更新菜单配置
   - 删除"数据加工"和"数据加工代码"
   - 添加"数据处理"

## 文件变更

| 文件 | 操作 |
|------|------|
| `web/src/views/processor/ProcessorPage.vue` | 新建，Tab 容器 |
| `web/src/views/processor/ProcessorManage.vue` | 修改，去掉标题，调整刷新按钮位置 |
| `web/src/views/worker/WorkerCodeEditor.vue` | 保持不变 |
| `web/src/router/index.ts` | 修改路由 |
| `web/src/components/Layout/MainLayout.vue` | 修改菜单 |
