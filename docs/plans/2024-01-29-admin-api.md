# 管理 API 实施计划

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** 实现缓存池管理、模板分析、定时任务、系统监控等管理 API。

**Architecture:** RESTful API + Gin 路由分组 + 统一响应格式

**Tech Stack:** Go, Gin

**依赖:** 阶段2-6

---

## Task 1: 创建 API 路由结构

**Files:**
- Create: `go-page-server/api/router.go`

**Step 1: 创建路由配置**

```go
package api

import (
	"github.com/gin-gonic/gin"

	"your-module/core"
)

// Dependencies API 依赖
type Dependencies struct {
	TemplateAnalyzer *core.TemplateAnalyzer
	TemplateFuncs    *core.TemplateFuncsManager
	DataPoolManager  *core.DataPoolManager
	Scheduler        *core.Scheduler
	TemplateCache    *core.TemplateCache
}

// SetupRouter 配置路由
func SetupRouter(r *gin.Engine, deps *Dependencies) {
	// 管理 API 分组
	admin := r.Group("/api/admin")
	{
		// 池管理
		pool := admin.Group("/pool")
		{
			pool.GET("/stats", NewPoolHandler(deps).GetStats)
			pool.GET("/presets", NewPoolHandler(deps).GetPresets)
			pool.POST("/preset/:name", NewPoolHandler(deps).ApplyPreset)
			pool.POST("/resize", NewPoolHandler(deps).Resize)
			pool.POST("/warmup", NewPoolHandler(deps).Warmup)
			pool.POST("/clear", NewPoolHandler(deps).Clear)
			pool.POST("/pause", NewPoolHandler(deps).Pause)
			pool.POST("/resume", NewPoolHandler(deps).Resume)
		}

		// 模板分析
		template := admin.Group("/template")
		{
			template.GET("/analysis", NewTemplateHandler(deps).GetAnalysis)
			template.GET("/analysis/:id", NewTemplateHandler(deps).GetTemplateAnalysis)
			template.POST("/analyze/:id", NewTemplateHandler(deps).AnalyzeTemplate)
			template.GET("/pool-config", NewTemplateHandler(deps).GetPoolConfig)
		}

		// 数据池
		data := admin.Group("/data")
		{
			data.GET("/stats", NewDataHandler(deps).GetStats)
			data.GET("/seo", NewDataHandler(deps).GetSEOAnalysis)
			data.GET("/recommendations", NewDataHandler(deps).GetRecommendations)
			data.POST("/refresh", NewDataHandler(deps).Refresh)
		}

		// 定时任务
		task := admin.Group("/task")
		{
			task.GET("/list", NewTaskHandler(deps).GetTasks)
			task.GET("/:id", NewTaskHandler(deps).GetTask)
			task.GET("/:id/logs", NewTaskHandler(deps).GetTaskLogs)
			task.POST("/:id/trigger", NewTaskHandler(deps).TriggerTask)
			task.POST("/:id/enable", NewTaskHandler(deps).EnableTask)
			task.POST("/:id/disable", NewTaskHandler(deps).DisableTask)
		}

		// 系统信息
		system := admin.Group("/system")
		{
			system.GET("/info", NewSystemHandler(deps).GetInfo)
			system.GET("/health", NewSystemHandler(deps).Health)
		}
	}
}
```

**Step 2: Commit**

```bash
git add go-page-server/api/router.go
git commit -m "feat: add admin API router structure"
```

---

## Task 2: 实现池管理 API

**Files:**
- Create: `go-page-server/api/pool_handler.go`

**Step 1: 创建池管理处理器**

```go
package api

import (
	"github.com/gin-gonic/gin"

	"your-module/core"
)

// PoolHandler 池管理处理器
type PoolHandler struct {
	deps *Dependencies
}

func NewPoolHandler(deps *Dependencies) *PoolHandler {
	return &PoolHandler{deps: deps}
}

// GetStats 获取池统计
func (h *PoolHandler) GetStats(c *gin.Context) {
	stats := h.deps.TemplateFuncs.GetPoolStats()
	core.Success(c, stats)
}

// GetPresets 获取预设配置
func (h *PoolHandler) GetPresets(c *gin.Context) {
	presets := core.GetAllPoolPresets()

	// 计算每个预设的预估值
	maxStats, _ := h.deps.TemplateAnalyzer.GetMaxStats()

	result := make(map[string]interface{})
	for name, preset := range presets {
		config := core.CalculatePoolSizes(preset, maxStats)
		memory := core.EstimateMemoryUsage(config)

		result[name] = map[string]interface{}{
			"preset":          preset,
			"calculated":      config,
			"estimated_memory": core.FormatMemorySize(memory),
		}
	}

	core.Success(c, result)
}

// ApplyPreset 应用预设配置
func (h *PoolHandler) ApplyPreset(c *gin.Context) {
	presetName := c.Param("name")

	preset, ok := core.GetPoolPreset(presetName)
	if !ok {
		core.FailWithCode(c, core.ErrNotFound)
		return
	}

	maxStats, _ := h.deps.TemplateAnalyzer.GetMaxStats()
	config := core.CalculatePoolSizes(preset, maxStats)

	h.deps.TemplateFuncs.ResizePools(config)
	h.deps.TemplateFuncs.WarmupPools(0.5)

	core.SuccessWithMessage(c, "预设已应用", config)
}

// ResizeRequest 调整大小请求
type ResizeRequest struct {
	ClsSize          int `json:"cls_size"`
	URLSize          int `json:"url_size"`
	KeywordEmojiSize int `json:"keyword_emoji_size"`
}

// Resize 手动调整池大小
func (h *PoolHandler) Resize(c *gin.Context) {
	var req ResizeRequest
	if err := c.ShouldBindJSON(&req); err != nil {
		core.FailWithError(c, core.ErrInvalidParams, err)
		return
	}

	config := &core.PoolSizeConfig{
		ClsPoolSize:          req.ClsSize,
		URLPoolSize:          req.URLSize,
		KeywordEmojiPoolSize: req.KeywordEmojiSize,
	}

	h.deps.TemplateFuncs.ResizePools(config)

	core.SuccessWithMessage(c, "池大小已调整", h.deps.TemplateFuncs.GetPoolStats())
}

// WarmupRequest 预热请求
type WarmupRequest struct {
	Percent float64 `json:"percent"` // 0-1
}

// Warmup 预热池
func (h *PoolHandler) Warmup(c *gin.Context) {
	var req WarmupRequest
	if err := c.ShouldBindJSON(&req); err != nil {
		req.Percent = 0.5
	}

	if req.Percent <= 0 || req.Percent > 1 {
		req.Percent = 0.5
	}

	h.deps.TemplateFuncs.WarmupPools(req.Percent)

	core.SuccessWithMessage(c, "预热完成", h.deps.TemplateFuncs.GetPoolStats())
}

// Clear 清空池
func (h *PoolHandler) Clear(c *gin.Context) {
	h.deps.TemplateFuncs.ClearPools()
	core.SuccessWithMessage(c, "池已清空", nil)
}

// Pause 暂停池补充
func (h *PoolHandler) Pause(c *gin.Context) {
	h.deps.TemplateFuncs.PausePools()
	core.SuccessWithMessage(c, "池补充已暂停", nil)
}

// Resume 恢复池补充
func (h *PoolHandler) Resume(c *gin.Context) {
	h.deps.TemplateFuncs.ResumePools()
	core.SuccessWithMessage(c, "池补充已恢复", nil)
}
```

**Step 2: Commit**

```bash
git add go-page-server/api/pool_handler.go
git commit -m "feat: implement pool management API"
```

---

## Task 3: 实现模板分析 API

**Files:**
- Create: `go-page-server/api/template_handler.go`

**Step 1: 创建模板分析处理器**

```go
package api

import (
	"strconv"

	"github.com/gin-gonic/gin"

	"your-module/core"
)

// TemplateHandler 模板分析处理器
type TemplateHandler struct {
	deps *Dependencies
}

func NewTemplateHandler(deps *Dependencies) *TemplateHandler {
	return &TemplateHandler{deps: deps}
}

// GetAnalysis 获取所有模板分析结果
func (h *TemplateHandler) GetAnalysis(c *gin.Context) {
	analyses := h.deps.TemplateAnalyzer.GetAllAnalyses()
	maxStats, maxTemplate := h.deps.TemplateAnalyzer.GetMaxStats()

	core.Success(c, map[string]interface{}{
		"templates":    analyses,
		"max_stats":    maxStats,
		"max_template": maxTemplate,
		"stats":        h.deps.TemplateAnalyzer.GetStats(),
	})
}

// GetTemplateAnalysis 获取单个模板分析结果
func (h *TemplateHandler) GetTemplateAnalysis(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	analysis, ok := h.deps.TemplateAnalyzer.GetAnalysis(id)
	if !ok {
		core.FailWithCode(c, core.ErrTemplateNotFound)
		return
	}

	core.Success(c, analysis)
}

// AnalyzeTemplate 分析指定模板
func (h *TemplateHandler) AnalyzeTemplate(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	// 从模板缓存获取模板
	tpl, ok := h.deps.TemplateCache.Get(id)
	if !ok {
		core.FailWithCode(c, core.ErrTemplateNotFound)
		return
	}

	// 执行分析
	analysis := h.deps.TemplateAnalyzer.AnalyzeTemplate(id, tpl.Name, tpl.Code)

	core.Success(c, analysis)
}

// GetPoolConfig 获取根据模板分析计算的池配置
func (h *TemplateHandler) GetPoolConfig(c *gin.Context) {
	config := h.deps.TemplateAnalyzer.CalculatePoolSize()
	memory := core.EstimateMemoryUsage(config)

	core.Success(c, map[string]interface{}{
		"config":           config,
		"estimated_memory": core.FormatMemorySize(memory),
	})
}
```

**Step 2: Commit**

```bash
git add go-page-server/api/template_handler.go
git commit -m "feat: implement template analysis API"
```

---

## Task 4: 实现数据池 API

**Files:**
- Create: `go-page-server/api/data_handler.go`

**Step 1: 创建数据池处理器**

```go
package api

import (
	"context"
	"time"

	"github.com/gin-gonic/gin"

	"your-module/core"
)

// DataHandler 数据池处理器
type DataHandler struct {
	deps *Dependencies
}

func NewDataHandler(deps *Dependencies) *DataHandler {
	return &DataHandler{deps: deps}
}

// GetStats 获取数据池统计
func (h *DataHandler) GetStats(c *gin.Context) {
	stats := h.deps.DataPoolManager.GetDetailedStats()
	core.Success(c, stats)
}

// GetSEOAnalysis 获取 SEO 友好度分析
func (h *DataHandler) GetSEOAnalysis(c *gin.Context) {
	analysis := h.deps.DataPoolManager.AnalyzeSEO(h.deps.TemplateAnalyzer)
	core.Success(c, analysis)
}

// GetRecommendations 获取优化建议
func (h *DataHandler) GetRecommendations(c *gin.Context) {
	recommendations := h.deps.DataPoolManager.GetRecommendations(h.deps.TemplateAnalyzer)
	core.Success(c, recommendations)
}

// RefreshRequest 刷新请求
type RefreshRequest struct {
	Pool string `json:"pool"` // all, keywords, images, titles, contents
}

// Refresh 刷新数据池
func (h *DataHandler) Refresh(c *gin.Context) {
	var req RefreshRequest
	if err := c.ShouldBindJSON(&req); err != nil {
		req.Pool = "all"
	}

	ctx, cancel := context.WithTimeout(c.Request.Context(), 30*time.Second)
	defer cancel()

	if err := h.deps.DataPoolManager.Refresh(ctx, req.Pool); err != nil {
		core.FailWithError(c, core.ErrDBQuery, err)
		return
	}

	stats := h.deps.DataPoolManager.GetStats()
	core.SuccessWithMessage(c, "数据池已刷新", stats)
}
```

**Step 2: Commit**

```bash
git add go-page-server/api/data_handler.go
git commit -m "feat: implement data pool API"
```

---

## Task 5: 实现任务管理 API

**Files:**
- Create: `go-page-server/api/task_handler.go`

**Step 1: 创建任务管理处理器**

```go
package api

import (
	"strconv"

	"github.com/gin-gonic/gin"

	"your-module/core"
)

// TaskHandler 任务管理处理器
type TaskHandler struct {
	deps *Dependencies
}

func NewTaskHandler(deps *Dependencies) *TaskHandler {
	return &TaskHandler{deps: deps}
}

// GetTasks 获取所有任务
func (h *TaskHandler) GetTasks(c *gin.Context) {
	tasks, err := h.deps.Scheduler.GetTasks(c.Request.Context())
	if err != nil {
		core.FailWithError(c, core.ErrDBQuery, err)
		return
	}

	core.Success(c, tasks)
}

// GetTask 获取单个任务
func (h *TaskHandler) GetTask(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	tasks, err := h.deps.Scheduler.GetTasks(c.Request.Context())
	if err != nil {
		core.FailWithError(c, core.ErrDBQuery, err)
		return
	}

	for _, task := range tasks {
		if task.ID == id {
			core.Success(c, task)
			return
		}
	}

	core.FailWithCode(c, core.ErrTaskNotFound)
}

// GetTaskLogs 获取任务日志
func (h *TaskHandler) GetTaskLogs(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	limitStr := c.DefaultQuery("limit", "20")
	limit, _ := strconv.Atoi(limitStr)
	if limit <= 0 || limit > 100 {
		limit = 20
	}

	logs, err := h.deps.Scheduler.GetTaskLogs(c.Request.Context(), id, limit)
	if err != nil {
		core.FailWithError(c, core.ErrDBQuery, err)
		return
	}

	core.Success(c, logs)
}

// TriggerTask 手动触发任务
func (h *TaskHandler) TriggerTask(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	if err := h.deps.Scheduler.TriggerTask(c.Request.Context(), id); err != nil {
		core.FailWithError(c, core.ErrTaskNotFound, err)
		return
	}

	core.SuccessWithMessage(c, "任务已触发", nil)
}

// EnableTask 启用任务
func (h *TaskHandler) EnableTask(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	if err := h.deps.Scheduler.EnableTask(c.Request.Context(), id); err != nil {
		core.FailWithError(c, core.ErrDBUpdate, err)
		return
	}

	core.SuccessWithMessage(c, "任务已启用", nil)
}

// DisableTask 禁用任务
func (h *TaskHandler) DisableTask(c *gin.Context) {
	idStr := c.Param("id")
	id, err := strconv.Atoi(idStr)
	if err != nil {
		core.FailWithCode(c, core.ErrInvalidParams)
		return
	}

	if err := h.deps.Scheduler.DisableTask(c.Request.Context(), id); err != nil {
		core.FailWithError(c, core.ErrDBUpdate, err)
		return
	}

	core.SuccessWithMessage(c, "任务已禁用", nil)
}
```

**Step 2: Commit**

```bash
git add go-page-server/api/task_handler.go
git commit -m "feat: implement task management API"
```

---

## Task 6: 实现系统信息 API

**Files:**
- Create: `go-page-server/api/system_handler.go`

**Step 1: 创建系统信息处理器**

```go
package api

import (
	"runtime"
	"time"

	"github.com/gin-gonic/gin"

	"your-module/core"
)

var startTime = time.Now()

// SystemHandler 系统信息处理器
type SystemHandler struct {
	deps *Dependencies
}

func NewSystemHandler(deps *Dependencies) *SystemHandler {
	return &SystemHandler{deps: deps}
}

// GetInfo 获取系统信息
func (h *SystemHandler) GetInfo(c *gin.Context) {
	var mem runtime.MemStats
	runtime.ReadMemStats(&mem)

	poolStats := h.deps.TemplateFuncs.GetPoolStats()
	dataStats := h.deps.DataPoolManager.GetStats()
	templateStats := h.deps.TemplateAnalyzer.GetStats()

	info := map[string]interface{}{
		"runtime": map[string]interface{}{
			"go_version":    runtime.Version(),
			"num_goroutine": runtime.NumGoroutine(),
			"num_cpu":       runtime.NumCPU(),
			"gomaxprocs":    runtime.GOMAXPROCS(0),
		},
		"memory": map[string]interface{}{
			"alloc":       core.FormatMemorySize(int64(mem.Alloc)),
			"total_alloc": core.FormatMemorySize(int64(mem.TotalAlloc)),
			"sys":         core.FormatMemorySize(int64(mem.Sys)),
			"heap_alloc":  core.FormatMemorySize(int64(mem.HeapAlloc)),
			"heap_sys":    core.FormatMemorySize(int64(mem.HeapSys)),
			"gc_cycles":   mem.NumGC,
		},
		"uptime": map[string]interface{}{
			"start_time": startTime,
			"duration":   time.Since(startTime).String(),
			"seconds":    int64(time.Since(startTime).Seconds()),
		},
		"pools":     poolStats,
		"data":      dataStats,
		"templates": templateStats,
	}

	core.Success(c, info)
}

// Health 健康检查
func (h *SystemHandler) Health(c *gin.Context) {
	// 检查各组件状态
	status := "healthy"
	checks := make(map[string]string)

	// 检查对象池
	poolStats := h.deps.TemplateFuncs.GetPoolStats()
	if poolStats == nil {
		checks["object_pool"] = "error"
		status = "degraded"
	} else {
		checks["object_pool"] = "ok"
	}

	// 检查数据池
	dataStats := h.deps.DataPoolManager.GetStats()
	if dataStats.KeywordsCount == 0 && dataStats.ImagesCount == 0 {
		checks["data_pool"] = "warning"
		if status == "healthy" {
			status = "degraded"
		}
	} else {
		checks["data_pool"] = "ok"
	}

	// 检查模板
	templateStats := h.deps.TemplateAnalyzer.GetStats()
	if templateStats["template_count"].(int) == 0 {
		checks["templates"] = "warning"
		if status == "healthy" {
			status = "degraded"
		}
	} else {
		checks["templates"] = "ok"
	}

	result := map[string]interface{}{
		"status":  status,
		"checks":  checks,
		"time":    time.Now(),
		"version": "1.0.0",
	}

	if status == "healthy" {
		core.Success(c, result)
	} else {
		core.SuccessWithMessage(c, status, result)
	}
}
```

**Step 2: Commit**

```bash
git add go-page-server/api/system_handler.go
git commit -m "feat: implement system info API"
```

---

## Task 7: 添加测试

**Files:**
- Create: `go-page-server/api/handler_test.go`

**Step 1: 创建测试文件**

```go
package api

import (
	"encoding/json"
	"net/http"
	"net/http/httptest"
	"testing"

	"github.com/gin-gonic/gin"

	"your-module/core"
)

func setupTestRouter() (*gin.Engine, *Dependencies) {
	gin.SetMode(gin.TestMode)
	r := gin.New()

	deps := &Dependencies{
		TemplateAnalyzer: core.NewTemplateAnalyzer(500, 1.5, 1.0),
		// 其他依赖需要 mock
	}

	return r, deps
}

func TestPoolHandler_GetPresets(t *testing.T) {
	r, deps := setupTestRouter()

	handler := NewPoolHandler(deps)
	r.GET("/presets", handler.GetPresets)

	req, _ := http.NewRequest("GET", "/presets", nil)
	w := httptest.NewRecorder()
	r.ServeHTTP(w, req)

	if w.Code != http.StatusOK {
		t.Errorf("Expected status 200, got %d", w.Code)
	}

	var response core.Response
	json.Unmarshal(w.Body.Bytes(), &response)

	if response.Code != 0 {
		t.Errorf("Expected code 0, got %d", response.Code)
	}
}

func TestTemplateHandler_GetAnalysis(t *testing.T) {
	r, deps := setupTestRouter()

	// 添加一些测试数据
	deps.TemplateAnalyzer.AnalyzeTemplate(1, "test.html", `{{ cls('x') }}`)

	handler := NewTemplateHandler(deps)
	r.GET("/analysis", handler.GetAnalysis)

	req, _ := http.NewRequest("GET", "/analysis", nil)
	w := httptest.NewRecorder()
	r.ServeHTTP(w, req)

	if w.Code != http.StatusOK {
		t.Errorf("Expected status 200, got %d", w.Code)
	}
}

func TestSystemHandler_Health(t *testing.T) {
	r, deps := setupTestRouter()

	handler := NewSystemHandler(deps)
	r.GET("/health", handler.Health)

	req, _ := http.NewRequest("GET", "/health", nil)
	w := httptest.NewRecorder()
	r.ServeHTTP(w, req)

	if w.Code != http.StatusOK {
		t.Errorf("Expected status 200, got %d", w.Code)
	}

	var response core.Response
	json.Unmarshal(w.Body.Bytes(), &response)

	if response.Code != 0 {
		t.Errorf("Expected code 0, got %d", response.Code)
	}
}
```

**Step 2: 运行测试**

```bash
cd go-page-server && go test -v ./api/...
```

Expected: PASS

**Step 3: Commit**

```bash
git add go-page-server/api/handler_test.go
git commit -m "test: add API handler tests"
```

---

## Task 8: 更新 main.go

**Files:**
- Modify: `go-page-server/main.go`

**Step 1: 添加 API 路由初始化**

```go
// 配置 API 路由
deps := &api.Dependencies{
	TemplateAnalyzer: templateAnalyzer,
	TemplateFuncs:    funcsManager,
	DataPoolManager:  dataPoolManager,
	Scheduler:        scheduler,
	TemplateCache:    templateCache,
}
api.SetupRouter(r, deps)
```

**Step 2: Commit**

```bash
git add go-page-server/main.go
git commit -m "feat: setup admin API routes in main"
```

---

## API 文档

### 池管理 API

| Method | Path | Description |
|--------|------|-------------|
| GET | /api/admin/pool/stats | 获取池统计 |
| GET | /api/admin/pool/presets | 获取预设配置 |
| POST | /api/admin/pool/preset/:name | 应用预设 |
| POST | /api/admin/pool/resize | 手动调整大小 |
| POST | /api/admin/pool/warmup | 预热池 |
| POST | /api/admin/pool/clear | 清空池 |
| POST | /api/admin/pool/pause | 暂停补充 |
| POST | /api/admin/pool/resume | 恢复补充 |

### 模板分析 API

| Method | Path | Description |
|--------|------|-------------|
| GET | /api/admin/template/analysis | 获取所有模板分析 |
| GET | /api/admin/template/analysis/:id | 获取单个模板分析 |
| POST | /api/admin/template/analyze/:id | 分析指定模板 |
| GET | /api/admin/template/pool-config | 获取计算的池配置 |

### 数据池 API

| Method | Path | Description |
|--------|------|-------------|
| GET | /api/admin/data/stats | 获取数据池统计 |
| GET | /api/admin/data/seo | 获取 SEO 分析 |
| GET | /api/admin/data/recommendations | 获取优化建议 |
| POST | /api/admin/data/refresh | 刷新数据池 |

### 任务管理 API

| Method | Path | Description |
|--------|------|-------------|
| GET | /api/admin/task/list | 获取所有任务 |
| GET | /api/admin/task/:id | 获取单个任务 |
| GET | /api/admin/task/:id/logs | 获取任务日志 |
| POST | /api/admin/task/:id/trigger | 手动触发 |
| POST | /api/admin/task/:id/enable | 启用任务 |
| POST | /api/admin/task/:id/disable | 禁用任务 |

### 系统 API

| Method | Path | Description |
|--------|------|-------------|
| GET | /api/admin/system/info | 获取系统信息 |
| GET | /api/admin/system/health | 健康检查 |

---

## 完成检查清单

- [ ] Task 1: 路由结构
- [ ] Task 2: 池管理 API
- [ ] Task 3: 模板分析 API
- [ ] Task 4: 数据池 API
- [ ] Task 5: 任务管理 API
- [ ] Task 6: 系统信息 API
- [ ] Task 7: 测试覆盖
- [ ] Task 8: main.go 集成

所有任务完成后运行完整测试：

```bash
cd go-page-server && go test -v ./...
```